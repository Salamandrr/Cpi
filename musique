#!/bin/sh
# On a $1 = le dossier de télechargement
#  J'ai rajouté des options pour qu'on ait plus de libertes
#Comportement de base du programme
musique_file=./
dowload_dir=$1

#Options
while getopts "f" option
do
	case $option in
		#On choisit ou on extrait la musique
		f)shift
		download_dir=$1
		musique_file=$2
		shift;;
		#Autre chose que l'option f
		?)echo "usage: option inconnue"
		exit 1;;
	esac
done
 
echo $1
#Liste tous les fichiers musicaux dans le dossier de telechargement
musique=`ls $download_dir | grep -P ".*- Jamendo - MP3.zip" >/tmp/musique.$$`
 
#On va extraire les archives une a une
while read line
do
    #On va affacer ce qu'il a en trop et on va creer le dossier
    namedir=`echo $line | cut -d'-' -f1,2`
	
	#On extrait l'archive sans afficher et sans remplacer les fichiers exitants
	unzip -qn $download_dir/"$line" -d $musique_file/"$namedir"
	 
done < /tmp/musique.$$
 
#Je supprime mon fichier temp
rm -f /tmp/musique.$$
